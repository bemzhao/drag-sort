<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="renderer" content="webkit">
	<title>拖拽排序</title>
	<!-- <link rel="stylesheet/less" href="css/style.less">
	<script src="js/less.min.js" ></script>
	<script>less.watch();</script> -->
	<link rel="stylesheet" href="css/style.css">
</head>
<body>
	<article>
		<ul>
			<h1>移动端拖拽排序</h1>
			<li>1、元素高度不定拖拽排序</li>
			<li>2、拖拽元素超出屏幕可向上或向下滚动页面</li>
			<li>3、新增元素也可拖动排序</li>
			<li>4、区分点击事件和长按拖拽排序</li>
		</ul>
	</article>

	<div class="addItem-btn"><a href="javascript:;"><i class="material-icons">add</i></a></div>

	<div id="list" class="list">
		<div class="item">
			<div class="num">1</div>
			<h4>选项1</h4>
			<div class="menu" style="">
				<span></span>
        <span></span>
        <span></span>
			</div>
		</div>
		<div class="item">
			<div class="num">2</div>
			<h4>选项2</h4>
			<div class="menu">
				<span></span>
		    <span></span>
		    <span></span>
			</div>
		</div>
		<div class="item">
			<div class="num">3</div>
			<h4>选项3</h4>
			<div class="menu">
				<span></span>
		    <span></span>
		    <span></span>
			</div>
		</div>
		<div class="item">
			<div class="num">4</div>
			<h4>选项4</h4>
			<div class="menu">
				<span></span>
		    <span></span>
		    <span></span>
			</div>
		</div>
		<div class="item">
			<div class="num">5</div>
			<h4>选项5选项5选项5选项5选项5选项5选项5选项5选项5选项5选项5选项5选项5选项5选项5选项5选项5选项5选项5选项5选项5选项5选项5选项5选项5选项5选项5选项5选项5选项5选项5选项5</h4>
			<div class="menu">
				<span></span>
		    <span></span>
		    <span></span>
			</div>
		</div>
		<div class="item">
			<div class="num">6</div>
			<h4>选项6选项6选项6选项6选项6选项6选项6选项6选项6</h4>
			<div class="menu">
				<span></span>
		    <span></span>
		    <span></span>
			</div>
		</div>
		<div class="item">
			<div class="num">7</div>
			<h4>选项7选项7选项7选项7选项7选项7选项7选项7选项7选项7选项7选项7选项7选项7选项7选项7</h4>
			<div class="menu">
				<span></span>
		    <span></span>
		    <span></span>
			</div>
		</div>
		<div class="item">
			<div class="num">8</div>
			<h4>选项8</h4>
			<div class="menu">
				<span></span>
		    <span></span>
		    <span></span>
			</div>
		</div>
		<div class="item">
			<div class="num">9</div>
			<h4>选项9</h4>
			<div class="menu">
				<span></span>
		    <span></span>
		    <span></span>
			</div>
		</div>
		<div class="item">
			<div class="num">10</div>
			<h4>选项10</h4>
			<div class="menu">
				<span></span>
		    <span></span>
		    <span></span>
			</div>
		</div>
		<div class="item">
			<div class="num">11</div>
			<h4>选项11选项11选项11选项11选项11选项11选项11选项11选项11选项11选项11选项11选项11选项11选项11选项11选项11选项11选项11选项11选项11选项11选项11选项11选项11选项11选项11选项11选项11选项11选项11选项11</h4>
			<div class="menu">
				<span></span>
		    <span></span>
		    <span></span>
			</div>
		</div>
		<div class="item">
			<div class="num">12</div>
			<h4>选项12选项12选项12选项12选项12选项12选项12选项12选项12</h4>
			<div class="menu">
				<span></span>
		    <span></span>
		    <span></span>
			</div>
		</div>
		<div class="item">
			<div class="num">13</div>
			<h4>选项13</h4>
			<div class="menu">
				<span></span>
		    <span></span>
		    <span></span>
			</div>
		</div>
		<div class="item">
			<div class="num">14</div>
			<h4>选项14</h4>
			<div class="menu">
				<span></span>
		    <span></span>
		    <span></span>
			</div>
		</div>
		<div class="item">
			<div class="num">15</div>
			<h4>选项15</h4>
			<div class="menu">
				<span></span>
		    <span></span>
		    <span></span>
			</div>
		</div>
		<div class="item">
			<div class="num">16</div>
			<h4>选项16</h4>
			<div class="menu">
				<span></span>
		    <span></span>
		    <span></span>
			</div>
		</div>
		<div class="item">
			<div class="num">17</div>
			<h4>选项17选项17选项17选项17选项17选项17选项17选项17选项17选项17选项17选项17</h4>
			<div class="menu">
				<span></span>
		    <span></span>
		    <span></span>
			</div>
		</div>
		<div class="item">
			<div class="num">18</div>
			<h4>选项18选项18选项18选项18选项18选项18选项18选项18选项18选项18选项18选项18选项18选项18选项18选项18选项18选项18选项18选项18选项18选项18选项18选项18选项18选项18选项18选项18选项18选项18选项18选项18</h4>
			<div class="menu">
				<span></span>
		    <span></span>
		    <span></span>
			</div>
		</div>
		<div class="item">
			<div class="num">19</div>
			<h4>选项19选项19选项19选项19选项19选项19选项19选项19选项19</h4>
			<div class="menu">
				<span></span>
		    <span></span>
		    <span></span>
			</div>
		</div>
		<div class="item">
			<div class="num">20</div>
			<h4>选项20</h4>
			<div class="menu">
				<span></span>
		    <span></span>
		    <span></span>
			</div>
		</div>
	</div>

	<script src="js/jquery-2.1.1.min.js"></script>
	<script src="js/drag.js"></script>
	<script>
		$(function () {
			new Drag({parent: ".list", item: ".item"});

			$(document).on("click", ".addItem-btn", function () {
				$(".list").prepend(`<div class="item">
					<div class="num">${$(".item").length+1}</div>
					<h4>新增的元素</h4>
					<div class="menu" style="">
						<span></span>
		        <span></span>
		        <span></span>
					</div>
				</div>`)
				$(".item").each((index, ele) => $(ele).find(".num").text(index+1));
			})

			$(document).on("click", ".item", function () {
				alert(`点击了第 ${$(this).index()+1} 个`)
				event.preventDefault();
			})

			setTimeout(function() {
				$(".addItem-btn").addClass("on");
			}, 300)

			$(window).scroll(function() {
				$(".addItem-btn").removeClass("on");
				clearTimeout($.data(this, 'scrollTimer'));
				$.data(this, 'scrollTimer', setTimeout(function() {
	        $(".addItem-btn").addClass("on");
	      }, 150));
			});
		})
	</script>
</body>
</html>